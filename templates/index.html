<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resume Builder</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <h1>Resume Builder</h1>
        {% if error %}
            <p style="color: red;">{{ error }}</p>
        {% endif %}
        <form action="/generate_resume" method="POST" enctype="multipart/form-data">
            
            <div class="section">
                <label for="template">Choose a Template:</label>
                <select name="template" required>
                    <option value="minimalist" {% if session['template'] == 'minimalist' %}selected{% endif %}>Minimalist</option>
                    <option value="professional" {% if session['template'] == 'professional' %}selected{% endif %}>Professional</option>
                    <option value="creative" {% if session['template'] == 'creative' %}selected{% endif %}>Creative</option>
                </select>
            </div>

            <div class="section">
                <label for="name">Full Name:</label>
                <input type="text" name="name" value="{{ session['name'] }}" required>

                <label for="job_title">Job Title:</label>
                <input type="text" name="job_title" value="{{ session['job_title'] }}" required>

                <label for="profile">Profile Summary:</label>
                <textarea name="profile" rows="4">{{ session['profile'] }}</textarea>
            </div>

            <div class="section" id="contact-section">
                <label for="contact">Contact Info:</label>
                <input type="text" name="contact" value="{{ session['contact'][0] if session['contact'] else '' }}">
                <button type="button" class="add-btn" onclick="addField('contact')">Add Contact</button>
            </div>

            <div class="section" id="experience-section">
                <label for="experience">Experience:</label>
                <input type="text" name="experience" value="{{ session['experience'][0] if session['experience'] else '' }}">
                <button type="button" class="add-btn" onclick="addField('experience')">Add Experience</button>
            </div>

            <div class="section" id="activities-section">
                <label for="activities">Activities:</label>
                <input type="text" name="activities" value="{{ session['activities'][0] if session['activities'] else '' }}">
                <button type="button" class="add-btn" onclick="addField('activities')">Add Activity</button>
            </div>

            <div class="section" id="hobbies-section">
                <label for="hobbies">Hobbies:</label>
                <input type="text" name="hobbies" value="{{ session['hobbies'][0] if session['hobbies'] else '' }}">
                <button type="button" class="add-btn" onclick="addField('hobbies')">Add Hobby</button>
            </div>

            <div class="section">
                <label for="photo">Upload Profile Picture:</label>
                <input type="file" name="photo" accept="image/*">
            </div>

            <button type="submit">Generate Resume</button>
        </form>
    </div>

    <script>
        function addField(section) {
            let sectionElement = document.getElementById(`${section}-section`);
            let inputFields = sectionElement.querySelectorAll(`input[name='${section}']`);
            
            // Create new input field for the section
            let newField = document.createElement("input");
            newField.setAttribute("type", "text");
            newField.setAttribute("name", section);
            sectionElement.insertBefore(newField, sectionElement.querySelector(".add-btn"));

            // Create the delete button
            let deleteButton = document.createElement("button");
            deleteButton.setAttribute("type", "button");
            deleteButton.classList.add("delete-btn");
            deleteButton.textContent = `Delete ${section.charAt(0).toUpperCase() + section.slice(1)}`;
            deleteButton.onclick = function () { deleteField(section, deleteButton) };
            sectionElement.appendChild(deleteButton);
        }

        function deleteField(section, button) {
            let sectionElement = document.getElementById(`${section}-section`);
            let inputFields = sectionElement.querySelectorAll(`input[name='${section}']`);
            
            if (inputFields.length > 1) {
                // Remove the last input field
                sectionElement.removeChild(inputFields[inputFields.length - 1]);
                // Remove the delete button
                sectionElement.removeChild(button);
            }
        }
    </script>
</body>
</html>
